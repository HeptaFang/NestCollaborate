# 永夜后日谈 Necronica 战斗部分程序化

## 基本规则

后日谈的战斗为一种特殊的回合制，基本的回合单元被称为“轮”。

与一般回合制战斗不同的是，一轮之中的行动又被细分为若干“刻”，每个行动会消耗一定的“刻”，因此在一轮中，每个单位都可以作出多次行动。

后日谈中，无论敌我均没有“生命值”的概念，取而代之的是“部件”。每个部件在战斗中都可以发挥一定作用，而在受到伤害时，若干部件会损坏，受到的伤害越高，一次性损毁的部件也越多。

每场战斗中，人偶们（玩家一方）均会有一个特定胜利条件，若达成目标，即使仍存在敌方单位也视为战斗结束，取得胜利。若在达成目标前，所有人偶均失去了所有攻击和移动手段，或全员狂气达到最高，则视为人偶方全灭。

### 回合

每个参战者都有一定的行动值，每轮的刻数等于所有参战者中最大的行动值。刻数由最大值开始，每次减去1，直到降低至零时进入下一轮。

当刻数和参战者当前行动值相等时，参战者在这一刻内可以做出行动。大部分行动会导致行动值的减少，在行动值减少后，就需要等待刻数再次降低到和行动值相等，才能继续行动。行动值可以降低至负数。

多名角色可行动的情况下，敌方先行动。人偶方行动顺序可自行决定。

一轮结束时，所有人偶增加一点狂气。

下一轮开始时，所有参战者恢复行动值，恢复的量等同于此时的最大行动值。若因为部件损毁等原因导致最大行动值下降，则恢复的量也会下降。若行动值在这一轮中降低到了负数，则恢复后的行动值也会比最大行动值更低。

### 场地

场地分为五个依次相连的区域：“乐园”，“花园”，“炼狱”，“地狱”，“奈落”。人偶的初期位置由PL决定，但仅能在“乐园”，“花园”，“炼狱”之中决定。

### 玩家单位（人偶）

### 敌方单位（棋子）

## 代码实现

